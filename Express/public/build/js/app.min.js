function init(){"use strict";new QueryLoader2(document.querySelector("body"),{barColor:"#ffffff",backgroundColor:"#2e2e2f",percentage:!0,barHeight:4,minimumTime:2500,fadeOutTime:700})}function initialize(e){posGlobal=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);var t={scrollwheel:!1,navigationControl:!1,mapTypeControl:!1,scaleControl:!1,draggable:!1,zoom:18,center:posGlobal,disableDefaultUI:!0,mapTypeId:google.maps.MapTypeId.SATELLITE},o=new google.maps.Map(document.getElementById("map-canvas"),t);mapGlobal=o;new google.maps.Marker({position:new google.maps.LatLng(e.coords.latitude,e.coords.longitude),map:o,animation:google.maps.Animation.DROP});google.maps.event.addDomListener(window,"scroll",function(){google.maps.event.trigger(mapGlobal,"resize"),mapGlobal.setCenter(posGlobal)})}function animate(){ctx.fillStyle="#608a36",ctx.fillRect(0,0,w,h),ctx.lineWidth=11,ctx.strokeStyle="#1f2c13",ctx.strokeRect(0,0,w,h),$.each(snakesArr,function(e,t){t.draw("#1f2c13","white",w,h,food)}),food.draw(),setTimeout(function(){animate()},100)}skrollr.init({smoothScrolling:!1,mobileDeceleration:.004}),$(document).ready(init);var socket=io.connect();$("#txtUsername").show();var messageLeft=$(".messageLeft"),messagRight=$(".messageRight");$(".messageLeft").remove(),$(".messageRight").remove();var currentRoom="",username="",messagesArr=[],socketId="";$("#txtUsername").keydown(function(e){13===e.keyCode&&""!==$(this).val()&&(username=$(this).val(),$(this).hide(),$("label").hide(),$("#selectRooms").show(),$("#rooms p").hide(),$("#chatInput").show())}),$("#selectRooms").change(function(){socket.emit("roomSelected",{room:$(this).val(),name:username}),currentRoom=$(this).val(),$("#selectRooms").hide(),$("#chatInput").show(),$("#changeRoom").show(),$("#chatInput").attr("placeholder","Press enter to submit"),$("#rooms p").show(),$("#rooms p").text("Room: "+currentRoom)}),$("#rooms p").click(function(){$(this).hide(),currentRoom="",$("#messages").children().remove(),$("#selectRooms").show(),$("#rooms p").hide(),$("#chatInput").attr("placeholder","Please Select a room above"),socket.emit("leaveRoom",currentRoom)}),$("#chatInput").keydown(function(e){13===e.keyCode&&(""!==$(this).val()&&""!==currentRoom?($("#chatInput").attr("placeholder","Press enter to submit"),socket.emit("message",$(this).val())):$("#chatInput").attr("placeholder","Please Select a room above"),$(this).val(""))}),socket.on("newMessage",function(e){$("#messages").children().length>=4&&$("#messages").children(":first-child").remove(),socketId==e.id?(messagRight.children(".message").text(e.mes),messagRight.children(".userTime").text(e.name+" "+e.time),messagRight.clone().appendTo("#messages")):(messageLeft.children(".message").text(e.mes),messageLeft.children(".userTime").text(e.name+" "+e.time),messageLeft.clone().appendTo("#messages"))}),socket.on("id",function(e){socketId=e}),function(){function e(e){initialize(e)}function t(e){var t="";switch(e.code){case e.PERMISSION_DENIED:t="This website does not have permission to use the Geolocation API";break;case e.POSITION_UNAVAILABLE:t="The current position could not be determined.";break;case e.PERMISSION_DENIED_TIMEOUT:t="The current position could not be determined within the specified timeout period."}if(""===t){var o=e.code.toString();t="The position could not be determined due to an unknown error (Code: "+o+")."}}var o,i=null;if(null===i&&(i=window.navigator),null!==i){var n=i.geolocation;null!==n?n.getCurrentPosition(e,t):initialize(o)}}();var posGlobal,mapGlobal,socket=io.connect(),canvas=$("#snakeCanvas")[0],ctx=canvas.getContext("2d"),w,h,celWidth=10,snakesArr=[],food,snake,socketid="";canvas.width=900,canvas.height=650,$("#snakePlay").on("click",function(){$("#snakeDiv").show(),$("#date").hide(),w=canvas.width,h=canvas.height,socket.emit("play")}),socket.on("ready",function(e){socketid=e,snake=new Snake(e,5,[],50,10),snake.create(),socket.emit("newSnake",{snake:snake,w:w,h:h,celWidth:celWidth})}),socket.on("PlayersReady",function(e){$("#waiting").hide(),snakesArr=e.snakes,$("#numplayers").text(snakesArr.length+" players"),$.each(snakesArr,function(e,t){t.__proto__=Object.getPrototypeOf(snake)}),food=new Food(e.food.x,e.food.y),animate()}),$(window).keydown(function(e){var t=e.keyCode;t>=37&&40>=t&&(e.preventDefault(),$.each(snakesArr,function(e,o){o.id==socketid&&(37===t&&"right"!==o.direction?socket.emit("control",{d:"left",x:o.nx,y:o.ny}):38===t&&"down"!==o.direction?socket.emit("control",{d:"up",x:o.nx,y:o.ny}):39===t&&"left"!==o.direction?socket.emit("control",{d:"right",x:o.nx,y:o.ny}):40===t&&"up"!==o.direction&&socket.emit("control",{d:"down",x:o.nx,y:o.ny}))}))}),socket.on("serverControl",function(e){$.each(snakesArr,function(t,o){o.id===e.id&&o.direction!=e.control.d&&(o.direction=e.control.d,o.nx=e.control.x,o.ny=e.control.y)})}),socket.on("newFood",function(e){food.x=e.x,food.y=e.y,$.each(snakesArr,function(t,o){o.id===e.id&&(o.tail={x:o.nx,y:o.ny},o.length++)})}),socket.on("disconnect",function(e){$.each(snakesArr,function(t,o){o.id===e.id&&snakesArr.splice(t,1)})});var Food=function(e,t,o){this.x=e,this.y=t,this.type=o};Food.prototype={draw:function(){ctx.fillStyle="#608a36",ctx.fillRect(this.x*celWidth,this.y*celWidth,celWidth,celWidth),ctx.fillStyle="#1f2c13",ctx.font="30px Arial",ctx.fillText("*",this.x*celWidth,this.y*celWidth+2*celWidth+2.5)}};var Snake=function(e,t,o,i,n){this.id=e,this.length=t,this.bodyArr=o,this.startX=i,this.startY=n,this.nx=0,this.ny=0;var s=["up","left","down"];this.direction=s[Math.floor(Math.random()*s.length)],this.tail=null};Snake.prototype={create:function(){for(var e=0;e<this.length;e++)this.bodyArr.push({x:e+this.startX,y:0+this.startY})},draw:function(e,t,o,i,n){this.nx=this.bodyArr[0].x,this.ny=this.bodyArr[0].y,"right"===this.direction?this.nx++:"left"===this.direction?this.nx--:"up"===this.direction?this.ny--:"down"===this.direction&&this.ny++,this.checkEatSelf(o,i),this.eat(n),this.bodyArr.unshift(this.tail);for(var s=0;s<this.bodyArr.length;s++){var a=this.bodyArr[s];ctx.fillStyle=e,ctx.fillRect(a.x*celWidth,a.y*celWidth,celWidth,celWidth),ctx.strokeStyle=t,ctx.lineWidth=1,ctx.strokeRect(a.x*celWidth,a.y*celWidth,celWidth,celWidth)}},checkEatSelf:function(e,t){this.nx<=-1?this.nx=e/celWidth:this.nx==e/celWidth&&(this.nx=-1),this.ny<=-1?this.ny=t/celWidth:this.ny>=t/celWidth&&(this.ny=-1),this.ckeckCollision()},ckeckCollision:function(){for(var e=0;e<this.bodyArr.length;e++)if(this.bodyArr[e].x==this.nx&&this.bodyArr[e].y==this.ny)return!0;return!1},eat:function(e){this.nx==e.x&&this.ny==e.y?(this.tail={x:this.nx,y:this.ny},this.length++,socket.emit("newFood",{w:w,h:h,celWidth:celWidth})):(this.tail=this.bodyArr.pop(),this.tail.x=this.nx,this.tail.y=this.ny)}};